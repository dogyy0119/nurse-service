(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/uni-quick-login/uni-quick-login"],{662:function(e,n,t){"use strict";t.r(n);var i=t(663),o=t(665);for(var r in o)["default"].indexOf(r)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(r);t(670);var u,s=t(54),c=Object(s["default"])(o["default"],i["render"],i["staticRenderFns"],!1,null,"d69f7544",null,!1,i["components"],u);c.options.__file="components/uni-quick-login/uni-quick-login.vue",n["default"]=c.exports},663:function(e,n,t){"use strict";t.r(n);var i=t(664);t.d(n,"render",(function(){return i["render"]})),t.d(n,"staticRenderFns",(function(){return i["staticRenderFns"]})),t.d(n,"recyclableRender",(function(){return i["recyclableRender"]})),t.d(n,"components",(function(){return i["components"]}))},664:function(e,n,t){"use strict";var i;t.r(n),t.d(n,"render",(function(){return o})),t.d(n,"staticRenderFns",(function(){return u})),t.d(n,"recyclableRender",(function(){return r})),t.d(n,"components",(function(){return i}));try{i={uniUserProfile:function(){return t.e("components/uni-user-profile/uni-user-profile").then(t.bind(null,866))}}}catch(s){if(-1===s.message.indexOf("Cannot find module")||-1===s.message.indexOf(".vue"))throw s;console.error(s.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var o=function(){var e=this,n=e.$createElement;e._self._c;e._isMounted||(e.e0=function(n,t){var i=arguments[arguments.length-1].currentTarget.dataset,o=i.eventParams||i["event-params"];t=o.item;t.path?e.to(t.path):e.login_before(t.id,!1)})},r=!1,u=[];o._withStripped=!0},665:function(e,n,t){"use strict";t.r(n);var i=t(666),o=t.n(i);for(var r in i)["default"].indexOf(r)<0&&function(e){t.d(n,e,(function(){return i[e]}))}(r);n["default"]=o.a},666:function(e,n,t){"use strict";(function(e,i){var o=t(4);Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=o(t(35)),u=o(t(11)),s=o(t(37)),c=t(22),a=o(t(667)),l=t(49),f=o(t(376));function g(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?g(Object(t),!0).forEach((function(n){(0,u.default)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var d=(0,c.initVueI18n)(a.default),v=d.t,h=e.database(),y=(h.collection("uni-id-users"),{computed:{loginConfig:function(){return getApp().globalData.config.router.login},agreements:function(){return getApp().globalData.config.about.agreements||[]}},data:function(){return{servicesList:[{id:"username",text:v("accountLogin"),logo:"/static/uni-quick-login/user.png",path:"/pages/ucenter/login-page/pwd-login/pwd-login"},{id:"smsCode",text:v("SMSLogin"),logo:"/static/uni-quick-login/sms.png",path:"/pages/ucenter/login-page/index/index?type=smsCode"},{id:"weixin",text:v("wechatLogin"),logo:"/static/uni-quick-login/wechat.png"},{id:"apple",text:v("appleLogin"),logo:"/static/uni-quick-login/apple.png"},{id:"univerify",text:v("oneClickLogin"),logo:"/static/uni-quick-login/univerify.png"},{id:"qq",text:v("QQLogin"),logo:"/static/uni-quick-login/univerify.png"},{id:"xiaomi",text:v("xiaomiLogin"),logo:"/static/uni-quick-login/univerify.png"},{id:"sinaweibo",text:v("weibo"),logo:"/static/uni-quick-login/univerify.png"}],config:{},univerifyStyle:{fullScreen:!0,backgroundColor:"#ffffff",buttons:{iconWidth:"45px",list:[]},privacyTerms:{defaultCheckBoxState:!1,textColor:"#BBBBBB",termsColor:"#5496E3",prefix:"我已阅读并同意",suffix:"并使用本机号码登录",privacyItems:[]}}}},watch:{agree:function(e){this.univerifyStyle.privacyTerms.defaultCheckBoxState=e}},props:{agree:{type:Boolean,default:function(){return!1}}},created:function(){var e=this;return(0,s.default)(r.default.mark((function n(){var t;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t=e.servicesList,t=t.filter((function(n){return e.loginConfig.includes(n.id)})),e.loginConfig.includes("univerify")&&(e.univerifyStyle.privacyTerms.privacyItems=e.agreements,t.forEach((function(n){var t=n.id,i=n.logo;n.path;"univerify"!=t&&e.univerifyStyle.buttons.list.push({iconPath:i,provider:t})}))),console.log(t),"/pages/ucenter/login-page/index/index"==e.getRoute(1)&&["weixin","apple"].includes(e.loginConfig[0])&&(t=t.filter((function(n){return n.id!=e.loginConfig[0]}))),e.servicesList=t.filter((function(n){var t=n.path?n.path.split("?")[0]:"";return t!=e.getRoute(1)})),console.log("servicesList",t,e.servicesList);case 7:case"end":return n.stop()}}),n)})))()},mounted:function(){},methods:p(p({},(0,l.mapMutations)({setUserInfo:"user/login"})),{},{getRoute:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=getCurrentPages();return e>n.length?"":"/"+n[n.length-e].route},to:function(e){if(console.log("比较",this.getRoute(1),this.getRoute(2),e),this.getRoute(1)==e.split("?")[0]&&"/pages/ucenter/login-page/index/index"==this.getRoute(1)){var n=e.split("?")[1].split("=")[1];i.$emit("setLoginType",n)}else this.getRoute(2)==e?i.navigateBack():this.getRoute(1)!=e?i.navigateTo({url:e,animationType:"slide-in-left"}):console.log("出乎意料的情况,path："+e)},login_before:function(e){var n=this;if(console.log(e),!this.agree&&"univerify"!=e)return i.showToast({title:v("noAgree"),icon:"none"});if("univerify"==e){var t=function(){i.hideLoading(),o.close(),o.offButtonsClick(u)},o=i.getUniverifyManager(),u=function(){var e=(0,s.default)(r.default.mark((function e(o){var u,s;return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("点击了第三方登录，provider：",o,o.provider,n.univerifyStyle.buttons.list),e.next=3,i.getCheckBoxState();case 3:u=e.sent[1].state,console.log("agree",u),i.$emit("setAgreementsAgree",u),s=n.univerifyStyle.buttons.list[o.index].path,console.log("path",s,n.getRoute(1)),s?(n.to(s),t()):u?(t(),setTimeout((function(){console.log("login_before"),n.login_before(o.provider)}),500)):(console.log(v("noAgree")),i.showToast({title:v("noAgree"),icon:"none"}));case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return o.onButtonsClick(u),console.log(this.univerifyStyle,o.login),o.login({univerifyStyle:this.univerifyStyle,success:function(e){console.log("login success",e),n.login(e.authResult,"univerify")},fail:function(e){i.showToast({title:JSON.stringify(e),icon:"none"})},complete:function(e){console.log(e),i.hideLoading(),o.offButtonsClick(u)}})}i.showLoading({mask:!0}),i.login({provider:e,onlyAuthorize:!0,complete:function(e){console.log(e),i.hideLoading()},success:function(){var t=(0,s.default)(r.default.mark((function t(i){var o;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log(i),"apple"!=e){t.next=6;break}return t.next=4,n.getUserInfo({provider:"apple"});case 4:o=t.sent,Object.assign(i.authResult,o.userInfo);case 6:n.login("weixin"==e?i.code:i.authResult,e);case 7:case"end":return t.stop()}}),t)})));function i(e){return t.apply(this,arguments)}return i}(),fail:function(){var e=(0,s.default)(r.default.mark((function e(n){return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log(n);case 1:case"end":return e.stop()}}),e)})));function n(n){return e.apply(this,arguments)}return n}()})},login:function(n,t){var o=this;console.log({params:n,type:t});var u="loginBy"+t.trim().toLowerCase().replace(t[0],t[0].toUpperCase());e.callFunction({name:"uni-id-cf",data:{action:u,params:n},success:function(){var e=(0,s.default)(r.default.mark((function e(n){var u;return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(u=n.result,console.log("login-result",u),0!==u.code){e.next=11;break}if(delete u.userInfo.token,"weixin"!=t||u.userInfo.nickname){e.next=6;break}return e.abrupt("return",o.$refs.userProfile.open(u.uid));case 6:"register"==u.type&&(u.userInfo._id=u.uid),o.setUserInfo(u.userInfo),(0,f.default)(u),e.next=12;break;case 11:i.showModal({content:u.msg,showCancel:!1});case 12:case"end":return e.stop()}}),e)})));function n(n){return e.apply(this,arguments)}return n}(),complete:function(e){console.log(e),"univerify"==t&&i.closeAuthView(),i.hideLoading()}})},doUserProfileNext:function(){(0,f.default)()},getUserInfo:function(e){return(0,s.default)(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,t){i.getUserInfo(p(p({},e),{},{success:function(e){n(e)},fail:function(e){i.showModal({content:JSON.stringify(e),showCancel:!1}),t(e)}}))})));case 1:case"end":return n.stop()}}),n)})))()}})});n.default=y}).call(this,t(34)["default"],t(2)["default"])},670:function(e,n,t){"use strict";t.r(n);var i=t(671),o=t.n(i);for(var r in i)["default"].indexOf(r)<0&&function(e){t.d(n,e,(function(){return i[e]}))}(r);n["default"]=o.a},671:function(e,n,t){}}]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/components/uni-quick-login/uni-quick-login.js.map
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/uni-quick-login/uni-quick-login-create-component',
    {
        'components/uni-quick-login/uni-quick-login-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('2')['createComponent'](__webpack_require__(662))
        })
    },
    [['components/uni-quick-login/uni-quick-login-create-component']]
]);
